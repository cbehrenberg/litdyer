pipeline {
	parameters {
		gitParameter branchFilter: 'origin/(.*)', defaultValue: 'dev', name: 'BRANCH', type: 'PT_BRANCH'
	}
	agent {
		docker {
			image "writio/maven:latest"
			args "-v /maven_repository:/maven_repository"
		}
	}
	stages {
		stage('git-checkout') {
			steps {
				echo "checking out git branch '${params.BRANCH}'..."
				git branch: "${params.BRANCH}", changelog: false, poll: false, url: 'https://github.com/cbehrenberg/writio.git'
			}
		}
		stage('mvn-clean-package') {
			steps {
				sh "mvn clean package -Dmaven.repo.local=/maven_repository"
			}
		}
		stage('mvn-install') {
			steps {
				sh 'mvn install -Dmaven.repo.local=/maven_repository'
			}
		}
	}
}